{% extends 'appTemps/base.html' %}
{% block 'body' %}
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <div>
    <h2>Average Scores</h2>
    <p>compound: {{ score.0 }} <p>
    <p>negative: {{ score.1 }} <p>
    <p>neutral: {{ score.2 }} <p>
    <p>positive: {{ score.3 }} <p>
    <img src='media/graph.png' /a>
  </div>

  <div id="graph"></div>

  <div id="tagModal" class="modal fade dialog-text" role="dialog">
    <div class="modal-dialog">

      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Edit Tag Comment</h4>
        </div>
        <div class="modal-body">
          <input id="modalInput" type="text" class="form-control" value="Edit tag here">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button id="modalSubmit" type="button" class="btn btn-primary">Save</button>
        </div>
      </div>

    </div>
  </div>

  <script>
    var tag = null;
    $.ajax({
      url: '/get_tags',
      type: 'GET',
      async: false,
      success: function(data) {
        tag = data.tags;
        console.log(tag);
      }
    });
    var myPlot = document.getElementById('graph'),
      x1 = [1, 2, 3, 4, 5],
      y1 = [1, 2, 4, 8, 16],
      data = [{x: x1, y: y1, text: tag, hoverinfo: ''}],
      layout = {
        hovermode:'closest',
        title: 'Results Data'
      };
    var graph = Plotly.newPlot(myPlot, data, layout);
    var pointIndex;

    myPlot.on('plotly_click', function(data) {
      var index = data.points[0].x - 1;
      pointIndex = index;
      $('#modalInput').val(tag[index]);
      $('#tagModal').modal('show');
    });

    $('button#modalSubmit').click(function(){
      var text = $('#modalInput').val();
      tag[pointIndex] = text;
      $('#tagModal').modal('hide');
      Plotly.redraw(myPlot);
    });
  </script>
{% endblock %}
